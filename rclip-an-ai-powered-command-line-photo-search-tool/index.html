<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: February 18, 2024 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="system">
  
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.2.0" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Yurij Mikhalevich" />

  
  
  
    
  
  <meta name="description" content="I have 72,769 photos stored on my NAS and organized into subfolders named according to the pattern &ldquo;YEAR.MM.DD - Event description.&rdquo; This organizational approach is software-agnostic and creates a structure that is easy to navigate." />

  
  <link rel="alternate" hreflang="en-us" href="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/" />

  
  
  
  
    
    <link rel="stylesheet" href="https://mikhalevi.ch/css/themes/purple.min.css" />
  

  
  
    
    <link href="https://mikhalevi.ch/dist/wc.min.css" rel="stylesheet" />
  

  
    
    <link href="https://mikhalevi.ch/css/custom.min.b700aec0141a2e70fad4540fa56cab156144e422bfc43cd0411670169b651186.css" rel="stylesheet" />
  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  












<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149478752-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-149478752-1', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>



























  
  <link rel="icon" type="image/png" sizes="32x32" href="https://mikhalevi.ch/media/icon_hu22f15536e9918e9e849189ceda99d382_340250_32x32_fill_lanczos_center_3.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://mikhalevi.ch/media/icon_hu22f15536e9918e9e849189ceda99d382_340250_16x16_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" sizes="300x300" type="image/png" href="https://mikhalevi.ch/media/icon_hu22f15536e9918e9e849189ceda99d382_340250_300x300_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/" />

  

  
    
    
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_be60103cf7a419ab5b393ee0c7b5e859.webp" />
  <meta name="twitter:title" content="rclip: An AI-Powered Command-Line Photo Search Tool | Yurij Mikhalevich" />
  <meta name="twitter:description" content="I have 72,769 photos stored on my NAS and organized into subfolders named according to the pattern &ldquo;YEAR.MM.DD - Event description.&rdquo; This organizational approach is software-agnostic and creates a structure that is easy to navigate." />
  <meta name="twitter:site" content="@theyurij" />
  <meta name="twitter:creator" content="@theyurij" />

  <meta property="og:site_name" content="Yurij Mikhalevich" />
  <meta property="og:url" content="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/" />
  <meta property="og:title" content="rclip: An AI-Powered Command-Line Photo Search Tool | Yurij Mikhalevich" />
  <meta property="og:description" content="I have 72,769 photos stored on my NAS and organized into subfolders named according to the pattern &ldquo;YEAR.MM.DD - Event description.&rdquo; This organizational approach is software-agnostic and creates a structure that is easy to navigate." />
  <meta property="og:image" content="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_be60103cf7a419ab5b393ee0c7b5e859.webp" />
  <meta property="og:locale" content="en-us" />

  
    
      <meta
        property="article:published_time"
        content="2021-08-25T07:02:27&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-08-25T07:02:27&#43;00:00">
  

  

  <title>rclip: An AI-Powered Command-Line Photo Search Tool | Yurij Mikhalevich</title>

  
  
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(https://mikhalevi.ch/dist/font/Inter.var.woff2) format("woff2");
    }
  </style>

  
  <link rel="alternate" href="https://mikhalevi.ch/rss.xml" title="Yurij Mikhalevich" type="application/rss+xml" />
  
  
  <link rel="alternate" href="https://mikhalevi.ch/tag/software-engineering/rss.xml" title="Software Engineering | Yurij Mikhalevich" type="application/rss+xml" />

  

  

  











  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.0d99234398222967acfc659035cc2c269fbae1a3f942642d1da3d4e4a7463027.js" integrity="sha256-DZkjQ5giKWes/GWQNcwsJp&#43;64aP5QmQtHaPU5KdGMCc="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="https://mikhalevi.ch/js/hugo-blox-en.min.078b219c8a98772427f102269cf46781e83e9f861633c0aaed4bcc882179e8ed.js"
    integrity="sha256-B4shnIqYdyQn8QImnPRngeg&#43;n4YWM8Cq7UvMiCF56O0="
  ></script>

  
  











</head>

  <body class="dark:bg-gray-800 dark:text-white-800 page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header ">
      
      
      
        
        
        
          <div class="absolute right-0 top-0 m-3 bg-primary-100 dark:bg-primary-700 rounded-full p-2 z-10">
  <div class="h-[24px] w-[24px]">
    <button class="theme-toggle" accesskey="t" title="" aria-label="Display preferences">
      <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
           fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
           stroke-linejoin="round" class="dark:hidden">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
      <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
           fill="none" stroke="white" stroke-width="2" stroke-linecap="round"
           stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
    </button>
  </div>
</div>

        
      
    </div>
    <div class="page-body  my-10">
      







<div class="flex flex-col items-center space-y-2">
  
  <a href="/">
      <img alt="Yurij Mikhalevich" class="aspect-square rounded-full bg-zinc-100 object-cover dark:bg-zinc-800" data-nimg="1" decoding="async"
                                                      height="60" loading="lazy"
                                                      src="/author/yurij-mikhalevich/avatar_hu1e000e9c50a9eca951db9b54a3873359_284455_200x200_fill_q85_h2_lanczos_center.webp"
                                                      style="color: transparent; background: linear-gradient(37.000000deg, #423a35b3, #423a3500 75%),linear-gradient(127.000000deg, #b4a491b3, #b4a49100 75%),linear-gradient(217.000000deg, #927062b3, #92706200 75%),linear-gradient(307.000000deg, #a08e76b3, #a08e7600 75%); background-size: cover; background-repeat: no-repeat;"
                                                      width="60">
    </a>
  
  <div class="font-normal tracking-widest">
    <a href="/">YURIJ MIKHALEVICH</a>
  </div>
</div>


<div class="mx-auto flex max-w-screen-lg">
  <article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-6 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <div class="w-full min-w-0 max-w-screen-lg px-6 pt-4 md:px-12">

      <div class="max-w-screen-md mx-auto">
        <div class="flex justify-between">
          <div class="mt-4 text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class="mr-1">August 25, 2021</span></div>

          
          
          <div class="mt-4">
            
            
              <a class="no-underline inline-block text-xs font-medium tracking-wider mt-1 uppercase text-primary-600 dark:text-primary-300" href="https://mikhalevi.ch/tag/software-engineering/">Software Engineering</a>
          </div>
          
        </div>

        <h1 class="mt-2 mb-10 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">rclip: An AI-Powered Command-Line Photo Search Tool</h1>
      </div>

      
      
      

      
      <div class="mx-auto article-header article-container featured-image-wrapper mb-10" style="max-width: 840px; max-height: 840px;">
        <div style="position: relative">
          <img
            srcset="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_3cb9bac47d8160f61cef71fcaaa2840a.webp 420w, https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_7a6b336d758104a188406b9624b3d1c1.webp 840w, https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_1680x1680_fit_q85_h2_lanczos.webp 1680w"
            src="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/featured_hufecf788dc4438ae3024a4a2ed127ff07_611805_3cb9bac47d8160f61cef71fcaaa2840a.webp"
            width="840"
            height="840"
            alt=""
            class="featured-image"
            style="background: linear-gradient(37.000000deg, #4b3d39b3, #4b3d3900 75%),linear-gradient(157.000000deg, #a78b72b3, #a78b7200 75%),linear-gradient(277.000000deg, #987054b3, #98705400 75%); background-size: cover; background-repeat: no-repeat;">
          
        </div>
      </div>
      

      <div class="mx-auto prose prose-slate lg:prose-xl dark:prose-invert">
        <p>I have 72,769 photos stored on my NAS and organized into subfolders named according to the pattern &ldquo;YEAR.MM.DD - Event description.&rdquo; This organizational approach is software-agnostic and creates a structure that is easy to navigate. I have followed it for more than a dozen years. However, there are situations when I want to find a particular photo. Looking for it even within a specific subfolder can take a lot of time, especially if that subfolder is packed with many pictures. Another challenging scenario is finding a picture that will fit a particular theme without having a specific one in mind. In both of these scenarios, having content-based search available is helpful. I looked around and didn&rsquo;t find a solution that satisfied me. What to do when you find yourself in a situation like this? Build your own solution!</p>
<p>Techniques allowing you to search images by their content are not necessarily new, but they usually only allow you to search using a set of predefined keywords and, sometimes, their synonyms. <a href="https://openai.com/blog/clip/" target="_blank" rel="noopener">OpenAI&rsquo;s CLIP</a> takes computer image understanding to a whole new level, allowing us to search for photos using any text query we can think of. This is why I used it to build my tool â€” rclip. In essence, rclip is a simple interface to the CLIP model. All I had to do was load the model, extract feature vectors from all of the images in the directory, store them somewhere, extract the feature vector from the query, compute similarities between the query feature vector and the image feature vectors, and output the most similar images. The vector extraction is done only once for each image, on the first run, and then the vectors are stored in the SQLite DB. SQLite is not the most performant way to manage that kind of data, but it&rsquo;s a quite convenient one. And, given that the time needed to query the DB on my 73 thousand photos catalog contributes only up to 12% of the whole execution time, I have decided to keep it for the time being.</p>
<p>I use <code>rgrep</code> a lot. <code>rgrep</code> is a simple alias to the <code>grep</code> command-line tool that searches recursively for a substring match in all of the files in the current directory. In its minimal definition (without a bunch of unwanted directories excluded), it looks like this: <code>alias rgrep=&quot;grep -rni&quot;</code>. To use it, open your terminal, navigate to the directory containing the files that you want to grep, type &ldquo;rgrep&rdquo; &ldquo;search query,&rdquo; and hit &ldquo;Enter.&rdquo;</p>
<p><code>rclip</code> implements exactly the same interface, but searches through the images&rsquo; content. The name stands for &ldquo;recursive CLIP.&rdquo; Its usage looks like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> images <span class="o">&amp;&amp;</span> rclip <span class="s2">&#34;search query&#34;</span>
</span></span></code></pre></div><p>













<figure class="flex flex-col justify-center items-center" >
  <div class="w-100" ><img alt="rclip usage demo"
          src="https://mikhalevi.ch/rclip-an-ai-powered-command-line-photo-search-tool/images/4deb9250-c353-11ee-b012-5f1e1a82f88a.gif"
          loading="lazy"
          class="!m-0" data-zoomable /></div></figure>
</p>
<p>For the detailed demonstration, watch the video below:</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/tAJHXOkHidw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>That&rsquo;s it! If you want to try <code>rclip</code> yourself, follow the installation instructions described <a href="https://github.com/yurijmikhalevich/rclip#readme" target="_blank" rel="noopener">here</a>.</p>

      </div>

      <div class="mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-6 lg:mt-4 flex justify-center"><a
          class="no-underline bg-primary-100 hover:bg-primary-600 text-primary-800 hover:text-primary-100 font-medium mr-2 px-4 py-1 rounded hover:rounded dark:bg-primary-300 dark:hover:bg-primary-700 dark:text-primary-700"
          href="mailto:yurij@mikhalevi.ch?subject=Re%3a%20rclip%3a%20An%20AI-Powered%20Command-Line%20Photo%20Search%20Tool&body=In%20reply%20to%20https%3a%2f%2fmikhalevi.ch%2frclip-an-ai-powered-command-line-photo-search-tool%2f">Reply</a>
      </div>

      <div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5">
        
        <div class="max-w-prose print:hidden">
  

</div>
<div class="flex flex-col items-center mt-8 max-w-prose">
  <div class="prose prose-slate dark:prose-invert font-normal tracking-widest">
    ABOUT YURIJ MIKHALEVICH
  </div>
  <div class="flex flex-col items-center mt-4">
  <div class="max-w-2xl mx-auto text-center prose prose-slate dark:prose-invert">
    Builds the future at <a href="https://lightning.ai" target="_blank">Lightning AI</a>,
    creator of the <a href="https://github.com/move-fast-and-break-things" target="_blank">Move Fast and Break Things community of software engineers</a>,
    <a href="https://community.deeplearning.ai/" target="_blank">DeepLearning.AI</a> mentor,
    creator of <a href="https://github.com/yurijmikhalevich/rclip" target="_blank">rclip</a>, writes about
    <a href="https://mikhalevi.ch/tag/tech/" class="">tech</a>,
    <a href="https://mikhalevi.ch/tag/software-engineering/" class="">software engineering</a>,
    <a href="https://mikhalevi.ch/tag/books/" class="">books</a>,
    <a href="https://mikhalevi.ch/tag/what-to-watch/" class="">what to watch</a>,
    and <a href="https://mikhalevi.ch/tag/beyond/" class="">beyond</a>,
    practices <a href="https://mikhalevi.ch/tag/creative-writing/" class="">creative writing</a>
    and captures moments through <a href="https://mikhalevi.ch/tag/photography/" class="">photography</a></div>
</div>

<div class="flex flex-col items-center mt-4">
  <div class="max-w-xxl mx-auto text-center prose prose-slate dark:prose-invert">
    

    

    
      This post is tagged with
        <a href="https://mikhalevi.ch/tag/software-engineering/">software engineering</a>. Grab the
      <a href="https://mikhalevi.ch/tag/software-engineering/rss.xml">software engineering RSS feed</a>
      or the <a href="https://mikhalevi.ch/rss.xml">main RSS feed</a> to get future posts.

    
  </div>
</div>


</div>

      </div>

    </div>
  </article>
</div>

    </div>
    <div class="page-footer">
      
    </div>

    
    











  </body>
</html>
